{"version":3,"file":"popup.js","mappings":";4QACA,ovNAMAA,OAAOC,SAAQ,WACbC,EAAE,YAAYC,QAAO,SAACC,GACpBA,EAAMC,iBACN,IAAMC,EAAWJ,EAAE,aAAaK,MAC1BC,EAAYN,EAAE,cAAcK,MAClCP,OAAOS,QAAQC,GAAGC,cAAcC,KAAKC,UAAU,CAAEP,SAAAA,EAAUE,UAAAA,IAC7D,IAEAN,EAAE,gBAAgBY,OAAM,WACtBd,OAAOS,QAAQC,GAAGC,cAAc,SAClC,GACF,IAEA,IAAII,EAAQ,KA8BZ,SAASC,EAAkBC,GACzB,IAAIC,EAAKD,EAAKE,OAAS,EACvBC,SAASC,eAAe,MAAMC,MAAQJ,EACtC,IAAIK,EAAQN,EAAK,GAAG,GACpBG,SAASC,eAAe,SAASC,MAAQC,CAC3C,CAjCAvB,OAAOC,QAAO,YAAC,8FACPuB,MAAMC,IAAG,6BAAC,WAAOhB,GAAO,yEAIP,OAHrBM,EAAQN,EAAQiB,SAASC,WAAWC,QAAQ,QACtCC,EAAad,EAAMe,OAAOF,QAAQ,eAClCG,EAAQF,EAAWG,oBACnBC,KAAK,UAAU,SACfxB,EAAQyB,OAAM,OAEpBlB,EADae,EAAMI,QACK,2CACzB,mDARc,IAQb","sources":["webpack://office-addin-taskpane-js/./src/dialogs/popup.js"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\nOffice.onReady(() => {\n  $(\"#my-form\").submit((event) => {\n    event.preventDefault();\n    const id_etape = $(\"#id_etape\").val();\n    const typeEtape = $(\"#typeEtape\").val();\n    Office.context.ui.messageParent(JSON.stringify({ id_etape, typeEtape }));\n  });\n\n  $(\"#cancel-form\").click(() => {\n    Office.context.ui.messageParent(\"cancel\");\n  });\n});\n\nvar sheet = null;\n\nOffice.onReady(async () => {\n  await Excel.run(async (context) => {\n    sheet = context.workbook.worksheets.getItem(\"_BDD\");\n    const baseEtapes = sheet.tables.getItem(\"baseEtapes\");\n    const range = baseEtapes.getDataBodyRange();\n    range.load(\"values\");\n    await context.sync();\n    const data = range.values;\n    remplirFormulaire(data);\n  });\n});\n\nasync function initForm() {\n  await Excel.run(async (context) => {\n    sheet = context.workbook.worksheets.getItem(\"_BDD\");\n    await context.sync();\n    const baseEtapes = sheet.tables.getItem(\"baseEtapes\");\n    await context.sync();\n    const range = baseEtapes.getDataBodyRange();\n    range.load(\"values\");\n    await context.sync();\n    console.log(\"Données de la table chargées !\");\n    console.log(range.values);\n    remplirFormulaire(range.values);\n    await context.sync();\n  });\n}\n\nfunction remplirFormulaire(data) {\n  var id = data.length + 1;\n  document.getElementById(\"id\").value = id;\n  var etape = data[0][1];\n  document.getElementById(\"etape\").value = etape;\n}\n"],"names":["Office","onReady","$","submit","event","preventDefault","id_etape","val","typeEtape","context","ui","messageParent","JSON","stringify","click","sheet","remplirFormulaire","data","id","length","document","getElementById","value","etape","Excel","run","workbook","worksheets","getItem","baseEtapes","tables","range","getDataBodyRange","load","sync","values"],"sourceRoot":""}