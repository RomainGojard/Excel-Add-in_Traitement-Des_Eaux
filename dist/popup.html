<!doctype html><html><head lang="en"><title>Dialog for My Office Add-in</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/9.6.1/css/fabric.min.css"/><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="3d455b43508ca8842c39.js"></script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="popup.js"></script></head><body style="display:flex;flex-direction:column;align-items:center;justify-content:center"><!doctype html><html><head><title>Tableau dynamique</title></head><body><table id="tableau"><thead><tr><th>ID</th><th>Étape</th><th>Pourcentage débit</th><th>Parent</th><th>Action</th></tr></thead><tbody><tr><td>1</td><td><select><option value="">Sélectionnez une étape</option><script>sheetNames=["Etape 1","Etape 2","Etape 3"],sheetNames.forEach((e=>{document.write(`<option value="${e}">${e}</option>`)}))</script></select></td><td><input name="pourcentage" value=""></td><td><select name="reference"><option value="">Aucun parent</option></select></td></tr></tbody><tfoot><tr><td colspan="5"><button type="button" onclick="ajouterLigne()">Ajouter une ligne</button></td></tr></tfoot></table><script>let compteur=2;function ajouterLigne(){const e=document.getElementById("tableau").getElementsByTagName("tbody")[0],t=e.insertRow(e.rows.length);t.insertCell(0).innerHTML=compteur++;t.insertCell(1).innerHTML='\n            <select>\n            <option value="null">Sélectionnez une étape</option>\n            <option value="Etape 1">Etape 1</option>\n            <option value="Etape 2">Etape 2</option>\n            <option value="Etape 3">Etape 3</option>\n            </select>';t.insertCell(2).innerHTML='<input type="text" name="pourcentage">';t.insertCell(3).innerHTML=construireListeReferences();t.insertCell(4).innerHTML='<button type="button" onclick="ajouterParent(this)">Ajouter un parent</button> <button type="button" onclick="supprimerLigne(this)">Supprimer</button> ',miseAJourListeReferences()}function supprimerLigne(e){const t=e.closest("tr");t.parentNode.removeChild(t),miseAJourListeReferences()}function construireListeReferences(){const e=document.createElement("select");e.name="reference";const t=document.createElement("option");return t.value="",t.textContent="Aucun parent",e.appendChild(t),e.outerHTML}function miseAJourListeReferences(){const e=document.querySelectorAll("#tableau tbody tr"),t=Array.from(e,(e=>e.querySelector("td:first-child").textContent));Array.from(document.querySelectorAll("#tableau tbody select[name='reference'] option:not(:first-child)")).forEach((e=>{e.remove()})),e.forEach((e=>{const n=e.querySelector("td:nth-child(4) select");t.forEach((t=>{if(t!==e.querySelector("td:first-child").textContent){const e=document.createElement("option");e.value=t,e.textContent=t,n.appendChild(e)}}))}))}function ajouterParent(e){const t=e.closest("tr"),n=t.querySelector("td:nth-child(3)"),o=t.querySelector("td:nth-child(4)"),r=document.createElement("select");r.name="reference",o.appendChild(r);const c=document.createElement("input");c.type="text",c.name="pourcentage",n.appendChild(c)}</script></body></html></body></html>